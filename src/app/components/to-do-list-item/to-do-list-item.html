<app-toast></app-toast>
<div class="filter">
  <app-button-component class="button__filter" [ngClass]="{'button__filter__selected':filter === null}" (onClick)="selectFilter(null)">Все</app-button-component>
  <app-button-component class="button__filter" [ngClass]="{'button__filter__selected':filter === 'InProgress'}" (onClick)="selectFilter('InProgress')">В работе</app-button-component>
  <app-button-component class="button__filter" [ngClass]="{'button__filter__selected':filter === 'Completed'}" (onClick)="selectFilter('Completed')">Выполненные</app-button-component>
</div>

<div class="tasks">
  <div class="list-tasks">
    <ul>
      @for(task of tasks; track task.id ){
        @if(task.status === filter || filter === null){
          <li >
            <div class="list-tasks__task" [ngClass]="{'task-selected': selectedTask?.id === task.id}">
              <span appTooltip="{{task.description}}" (click)="selectTask(task)">{{task.title}}</span>
              <input class="checkbox" type="checkbox" [checked]="task.status === 'Completed'" (change)="changeStatusTask(task)">
            </div>
          </li>
        }
      }
    </ul>
  </div>
  @if(selectedTask){
    <div class="sidebar" (dblclick)="editTask()">
      @if(!editTaskFlag){
        <div class="description-content">
          <h2>{{selectedTask.title}}</h2>
          <h3>Описание</h3>
          <span>{{selectedTask.description}}</span>
        </div>
        <app-button-component class="button__delete" appTooltip="Удаляет задачу" (onClick)="delTask(selectedTask.id)">Удалить</app-button-component>
      }
      @else {
        <div class="editform">
          <div class="edit-fields">
            <textarea class="edit-task-field" placeholder="Редактировать задачу" cols="30" rows="3" [(ngModel)]="changingTitle"></textarea>
            <h3>Описание</h3>
            <textarea class="edit-task-field" [(ngModel)]="changingDescription" cols="30" rows="10"></textarea>
          </div>
          <div class="edit-btn">
            <app-button-component class="button__add" (onClick)="saveChangesTask()">Сохранить</app-button-component>
          </div>
        </div>
      }
    </div>
  }
</div>
